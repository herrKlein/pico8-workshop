pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
t=0
tps=1 -- ticks/sec

col = 0

function _init()
 pl = {
  x=0, 
  y=0,
  w=16,
  h=16,
  color=3
 }
end

function _update60()
	x_old=pl.x
	y_old=pl.y
	
 if (btn(0)) pl.x -= 1
 if (btn(1)) pl.x += 1
 if (btn(2)) pl.y -= 1
 if (btn(3)) pl.y += 1
 
 col=collide(pl,0)
 
 if col == 1 then
 	pl.x = x_old
 	pl.y = y_old
 end
end

function _draw()
 cls(12)
 map()
 print(col,30,20)
 spr(1,pl.x,pl.y,2,2)
end

-->8
-- hit collission
function collide(plr) -- returns flag,tile if hit
 -- Calculate the tile indices of the four corners of the sprite
 local corners = {
  { x = flr(plr.x / 8), y = flr(plr.y / 8) },
  { x = flr((plr.x + plr.w - 1) / 8), y = flr(plr.y / 8) },
  { x = flr((plr.x + plr.w - 1) / 8), y = flr((plr.y + plr.h - 1) / 8) },
  { x = flr(plr.x / 8), y = flr((plr.y + plr.h - 1) / 8) },
}
 for i, corner in ipairs(corners) do
   -- Calculate the tile index of the current corner
  local flag = fget(mget(corner.x, corner.y))

  printh(corner.x .." | ".. corner.y .." | ".. i)

  if flag>0 then
   return flag, {x=tile_x, y=tile_y}
  end
 end

 -- No collision detected
 return nil, nil
end


__gfx__
00000000000009999990000088888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999999999900088888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999999999990088888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000099999999999999088888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000099999999999999088888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999988888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999988888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999988888888000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000999999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000099999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000099999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000009999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
88888777777888eeeeee888888888888888888888888888888888888888888888888888888888888888ff8ff8888228822888222822888888822888888228888
8888778887788ee88eee88888888888888888888888888888888888888888888888888888888888888ff888ff888222222888222822888882282888888222888
888777878778eeee8eee88888e88888888888888888888888888888888888888888888888888888888ff888ff888282282888222888888228882888888288888
888777878778eeee8eee8888eee8888888888888888888888888888888888888888888888888888888ff888ff888222222888888222888228882888822288888
888777878778eeee8eee88888e88888888888888888888888888888888888888888888888888888888ff888ff888822228888228222888882282888222288888
888777888778eee888ee888888888888888888888888888888888888888888888888888888888888888ff8ff8888828828888228222888888822888222888888
888777777778eeeeeeee888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111666161111111111111111771111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111616161111111777111111711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111666161111111111111117711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111611161111111777111111711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111611166611111111111111771111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161611111ccc111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161617771c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111116111111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161617771c1c117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161611111ccc171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161611111ccc111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111161617771c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166611111c1c111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111617771c1c117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111166611111ccc171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1111111111bb11bb1b1111bb1bbb11111ccc11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111b111b1b1b111b1b1b1b1777111c11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111b111b1b1b111b1b1bb1111111cc11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111111b111b1b1b111b1b1b1b1777111c11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1111111111bb1bb11bbb1bb11b1b11111ccc11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111771111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111177111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111771111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1ee11ee111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1ee11e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1eee11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1ee111ee1eee1eee11ee1ee1111111111616166616611666166616661611166611711171111111111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111111111616161616161616116116111611161617111117111111111111111111111111111111111111111111111111
1ee11e1e1e1e1e1111e111e11e1e1e1e111111111616166616161666116116611666161617111117111111111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111111111616161116161616116116111616161617111117111111111111111111111111111111111111111111111111
1e1111ee1e1e11ee11e11eee1ee11e1e111116661166161116661616116116661666166611711171111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111eee1eee111111711bbb1bbb1bb111711ccc117111711111166616111111161611111111111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b17111c1c11171117111116161611111116161111111117771111111c1111111111111111111111111111111111111111
111111e11ee1111117111bb111b11b1b17111c1c111711171111166616111111116111111777111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b17111c1c111711171111161116111111161611111111177711111c111111111111111111111111111111111111111111
11111eee1e11111111711bbb11b11b1b11711ccc117111711111161116661171161611111111111111111ccc1111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111eee1eee111111711bbb1bbb1bb111711cc1117111711111166616111111161611111111111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b171111c111171117111116161611111116161111117117771111111c1111111111111111111111111111111111111111
111111e11ee1111117111bb111b11b1b171111c1111711171111166616111111116111111777111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b171111c1111711171111161116111111161611111171177711111c111111111111111111111111111111111111111111
11111eee1e11111111711bbb11b11b1b11711ccc117111711111161116661171161611111111111111111ccc1111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111eee1eee111111711bbb1bbb1bb111711ccc117111711111166616111111161611111111111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b1711111c11171117111116161611111116161111111117771111111c1111111111111111111111111111111111111111
111111e11ee1111117111bb111b11b1b17111ccc111711171111166616111111166611111777111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b17111c11111711171111161116111111111611111111177711111c111111111111111111111111111111111111111111
11111eee1e11111111711bbb11b11b1b11711ccc117111711111161116661171166611111111111111111ccc1111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111eee1eee111111711bbb1bbb1bb111711ccc117111711111166616111111161611111111111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b1711111c11171117111116161611111116161111117117771111111c1111111111111111111111111111111111111111
111111e11ee1111117111bb111b11b1b171111cc111711171111166616111111166611111777111111111ccc1111111111111111111111111111111111111111
111111e11e11111117111b1b11b11b1b1711111c111711171111161116111111111611111171177711111c111111111111111111111111111111111111111111
11111eee1e11111111711bbb11b11b1b11711ccc117111711111161116661171166611111111111111111ccc1111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1ee11ee111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1ee11e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1eee11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1e1e1ee111ee1eee1eee11ee1ee1111111111661166616661616117111711111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111111111616161616161616171111171111111111111111111111111111111111111111111111111111111111111111
1ee11e1e1e1e1e1111e111e11e1e1e1e111111111616166116661616171111171111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e1e1111e111e11e1e1e1e111111111616161616161666171111171111111111111111111111111111111111111111111111111111111111111111
1e1111ee1e1e11ee11e11eee1ee11e1e111116661666161616161666117111711111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111bb1b1111bb11711cc11ccc1171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111b111b111b11171111c1111c1117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111b111b111bbb171111c11ccc1117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111b111b11111b171111c11c111117111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111bb1bbb1bb111711ccc1ccc1171111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111118888811111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
111111bb1bbb1bbb887886661611111116161111166616111111161611111c111ccc117111111111111111111111111111111111111111111111111111111111
11111b111b1b1b1b878886161611111116161111161616111111161611111c111c1c111711111111111111111111111111111111111111111111111111111111
11111bbb1bbb1bb1878881661611111111611111166616111111166611111ccc1c1c111711111111111111111111111111111111111111111111111111111111
1111111b1b111b1b878817111611111116161171161116111111111611711c1c1c1c111711111111111111111111111111111111111111111111111111111111
11111bb11b111b1b887817711666117116161711161116661171166617111ccc1ccc117111111111111111111111111111111111111111111111111111111111
11111111111111111111177711111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111bbb1bbb1bbb1171177771111ccc11111ccc11111cc11c1111111cc11c111171111111111111111111111111111111111111111111111111111111111111
11111bbb1b1b1b1b1711177111111c1c11111c1c111111c11c11111111c11c111117111111111111111111111111111111111111111111111111111111111111
11111b1b1bbb1bbb1711111711111c1c11111c1c111111c11ccc111111c11ccc1117111111111111111111111111111111111111111111111111111111111111
11111b1b1b1b1b1117111c1c11711c1c11711c1c117111c11c1c117111c11c1c1117111111111111111111111111111111111111111111111111111111111111
11111b1b1b1b1b1111711ccc17111ccc17111ccc17111ccc1ccc17111ccc1ccc1171111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1eee1ee11ee111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1ee11e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
1e111e1e1e1e11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
82888222822882228888822282288882822282828888888888888888888888888888888888888888888888888228822282228882822282288222822288866688
82888828828282888888888288288828888282828888888888888888888888888888888888888888888888888828828288828828828288288282888288888888
82888828828282288888822288288828822282228888888888888888888888888888888888888888888888888828822282228828822288288222822288822288
82888828828282888888828888288828828888828888888888888888888888888888888888888888888888888828828282888828828288288882828888888888
82228222828282228888822282228288822288828888888888888888888888888888888888888888888888888222822282228288822282228882822288822288
88888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888

__gff__
0000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000003030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000003030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
